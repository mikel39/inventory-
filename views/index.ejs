<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventory</title>
  <link rel="stylesheet" href="/styles.css">
</head>

<body>

  <header>
    <a href="/new" class="btn add-book" target="_blank">Add a book</a>
  </header>
  <main>
    <div class="form-container">
      <form action="/page/<%= settings.page %>" method="GET">
        <fieldset>
          <label for="limit">Limit</label>
          <input type="number" name="limit" id="limit" value="<%= settings.limit %>" />
        </fieldset>
        <fieldset>
          <label for="order">Order by</label>
          <select name="order" id="order">
            <option value="df">Default</option>
            <option value="rating" <%=settings.order==='rating' ? 'selected' : '' %> >Rating</option>
            <option value="title" <%=settings.order==='title' ? 'selected' : '' %> >Alphabetically</option>
            <option value="release_date" <%=settings.order==='release_date' ? 'selected' : '' %> >Release Date</option>
            <option value="pages" <%=settings.order==='pages' ? 'selected' : '' %>>Pages</option>
          </select>
        </fieldset>
        <fieldset>

          <label for="author">Author</label>
          <select name="author" id="author">
            <option value="df">All</option>
            <% authors.map((author)=> { %>
              <option value="<%= author.id %>" <%=settings.author==author.id ? 'selected' : '' %>
                >
                <%= author.tag %>
              </option>
              <% }) %>
          </select>
        </fieldset>
        <fieldset>
          <legend>Genres</legend>
          <% genres.map((gn)=> { %>
            <label>
              <input type="checkbox" name="genre" value="<%= gn.id %>" <%=settings.genre.includes(String(gn.id))
                ? 'checked' : '' %> /> <%= gn.tag %>
            </label>
            <% }) %>
        </fieldset>

        <button type="submit" class="btn">Apply</button>
      </form>
    </div>
    <div class="list-container">
      <ul>
        <% books.map((book, index)=> { %>
          <li>
            <a href="/book/<%= book.slug %>" target="_blank">
              <span class="title">
                <%= book.title %>
              </span>
              <div class="data-container">
                <span>
                  Rating:
                  <%= book.rating.toFixed(1) %>
                </span>
                <span>
                  Pages:
                  <%= book.pages %>
                </span>
                <span>
                  Year:
                  <%= new Date(book.release_date).getFullYear() %>
                </span>
              </div>
            </a>
            <div class="btns-container">
              <a class="btn" href="/edit/<%= book.slug%>" target="_blank">Edit</a>
              <form action="/delete" method="POST">
                <input type="hidden" name="id" value="<%= book.id %>">
                <button class="btn" type="submit">Delete</button>
              </form>
            </div>

          </li>
          <% }) %>
      </ul>
      <div class="pages-container">
        <% [...Array(settings.pages).keys()].map(key=> { %>
          <a href="/page/<%= key %>" class="page-anchor <%=settings.page == key ? 'current-page' : '' %>">
            <%= key + 1 %>
          </a>
          <% }) %>

      </div>
    </div>
  </main>


</body>

</html>